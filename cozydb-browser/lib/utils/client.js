// Generated by CoffeeScript 1.10.0
var playRequest;

module.exports = {
  get: function(auth, path, attributes, callback) {
    return playRequest(auth, 'GET', path, attributes, function(error, body, response) {
      return callback(error, body, response);
    });
  },
  post: function(auth, path, attributes, callback) {
    return playRequest(auth, 'POST', path, attributes, function(error, body, response) {
      return callback(error, body, response);
    });
  },
  put: function(auth, path, attributes, callback) {
    console.log('put');
    return playRequest(auth, 'PUT', path, attributes, function(error, body, response) {
      return callback(error, body, response);
    });
  },
  del: function(auth, path, attributes, callback) {
    return playRequest(auth, 'DELETE', path, attributes, function(error, body, response) {
      return callback(error, body, response);
    });
  }
};

playRequest = function(auth, method, path, attributes, callback) {
  var xhr;
  xhr = new XMLHttpRequest;
  xhr.open(method, "/ds-api/" + path, true);
  xhr.onload = function() {
    return callback(null, xhr.response, xhr);
  };
  xhr.onerror = function(e) {
    var err;
    err = 'Request failed : #{e.target.status}';
    return callback(err);
  };
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.setRequestHeader('Authorization', 'Basic ' + btoa(auth.appName + ':' + auth.token));
  if (attributes != null) {
    xhr.send(JSON.stringify(attributes));
  } else {
    xhr.send();
  }
};
